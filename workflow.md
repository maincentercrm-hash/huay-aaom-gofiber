# Retirement Lottery Mission System - Workflow

## р╕гр╕░р╕Ър╕Ър╕ар╕▓р╕Юр╕гр╕зр╕б
**Retirement Lottery Mission System** р╣Ар╕Ыр╣Зр╕Щр╣Бр╕Юр╕ер╕Хр╕Яр╕нр╕гр╣Мр╕бр╕Бр╕▓р╕гр╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕бр╕┤р╕Кр╕Кр╕▒р╕Щр╣Ар╕Фр╕┤р╕бр╕Юр╕▒р╕Щр╣Бр╕Ър╕Ър╣Ар╕Бр╕бр╕бр╕┤р╕Яр╕▓р╕в р╕Чр╕╡р╣Ир╣Гр╕лр╣Йр╕Ьр╕╣р╣Йр╣Гр╕Кр╣Йр╕Чр╕│р╕бр╕┤р╕Кр╕Кр╕▒р╕Щ 3 р╕гр╕░р╕Фр╕▒р╕Ър╕Хр╕▓р╕бр╕Бр╕┤р╕Ир╕Бр╕гр╕гр╕бр╕Бр╕▓р╕гр╣Ар╕Фр╕┤р╕бр╕Юр╕▒р╕Щ р╣Ар╕Юр╕╖р╣Ир╕нр╕гр╕▒р╕Ър╕гр╕▓р╕Зр╕зр╕▒р╕ер╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤

## р╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕З User Roles

### 1. **Admin (р╕Ьр╕╣р╣Йр╕Фр╕╣р╣Бр╕ер╕гр╕░р╕Ър╕Ъ)**
- р╣Ар╕Вр╣Йр╕▓р╕кр╕╣р╣Ир╕гр╕░р╕Ър╕Ър╕Фр╣Йр╕зр╕в Email/Password
- р╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕Бр╕▓р╕гр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╕гр╕░р╕Ър╕Ъ
- р╕Фр╕╣р╕кр╕Цр╕┤р╕Хр╕┤р╣Бр╕ер╕░р╕гр╕▓р╕вр╕Зр╕▓р╕Щ
- р╕Др╕зр╕Ър╕Др╕╕р╕б Template р╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╣Бр╕ер╕░р╕гр╕╣р╕Ыр╣Бр╕Ър╕Ър╣Ар╕зр╣Зр╕Ър╣Др╕Лр╕Хр╣М

### 2. **Client/User (р╕Ьр╕╣р╣Йр╣Гр╕Кр╣Йр╕Чр╕▒р╣Ир╕зр╣Др╕Ы)**
- р╣Ар╕Вр╣Йр╕▓р╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╕Ьр╣Ир╕▓р╕Щ LINE Bot
- р╕Чр╕│р╕бр╕┤р╕Кр╕Кр╕▒р╕Щр╣Ар╕Фр╕┤р╕бр╕Юр╕▒р╕Щр╣Ар╕Юр╕╖р╣Ир╕нр╕гр╕▒р╕Ър╕гр╕▓р╕Зр╕зр╕▒р╕е
- р╕гр╕▒р╕Ър╕Бр╕▓р╕гр╣Бр╕Ир╣Йр╕Зр╣Ар╕Хр╕╖р╕нр╕Щр╕Ьр╣Ир╕▓р╕Щ LINE

---

## Workflow р╕Бр╕▓р╕гр╕Чр╕│р╕Зр╕▓р╕Щр╕Хр╕▓р╕б Role

### ЁЯФз **Admin Workflow**

```
1. Login р╣Ар╕Вр╣Йр╕▓р╕гр╕░р╕Ър╕Ъ
   тФФтФАтФА JWT Authentication

2. р╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕Бр╕▓р╕гр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓
   тФЬтФАтФА р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ Tier (р╕гр╕░р╕Фр╕▒р╕Ър╕бр╕┤р╕Кр╕Кр╕▒р╕Щ)
   тФЬтФАтФА р╣Бр╕Бр╣Йр╣Др╕В Template р╕Вр╣Йр╕нр╕Др╕зр╕▓р╕б LINE
   тФЬтФАтФА р╕нр╕▒р╕Юр╣Вр╕лр╕ер╕Фр╕гр╕╣р╕Ыр╕ар╕▓р╕Ю (Firebase)
   тФФтФАтФА р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ API р╕ар╕▓р╕вр╕Щр╕нр╕Б

3. р╕Хр╕┤р╕Фр╕Хр╕▓р╕бр╕кр╕Цр╕┤р╕Хр╕┤ Dashboard
   тФЬтФАтФА р╕Ир╕│р╕Щр╕зр╕Щр╕бр╕┤р╕Кр╕Кр╕▒р╕Щр╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф
   тФЬтФАтФА р╕кр╕Цр╕┤р╕Хр╕┤р╕Хр╕▓р╕б Tier
   тФФтФАтФА р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Ьр╕╣р╣Йр╣Гр╕Кр╣Йр╕Чр╕╡р╣Ир╕Хр╕┤р╕Фр╕Хр╣Ир╕нр╣Др╕Фр╣Й
```

### ЁЯСд **User Workflow**

```
1. р╣Ар╕гр╕┤р╣Ир╕бр╕Хр╣Йр╕Щр╕Ир╕▓р╕Б LINE Bot
   тФФтФАтФА р╕Фр╕╢р╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Ир╕▓р╕Б LINE Profile

2. р╕ер╕Зр╕Чр╕░р╣Ар╕Ър╕╡р╕вр╕Щр╕Вр╣Йр╕нр╕бр╕╣р╕е
   тФЬтФАтФА р╣Ар╕Юр╕┤р╣Ир╕бр╣Ар╕Ър╕нр╕гр╣Мр╣Вр╕Чр╕гр╕ир╕▒р╕Юр╕Чр╣М
   тФФтФАтФА р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Бр╕▒р╕Ър╕гр╕░р╕Ър╕Ър╕ар╕▓р╕вр╕Щр╕нр╕Б

3. р╣Ар╕гр╕┤р╣Ир╕бр╕бр╕┤р╕Кр╕Кр╕▒р╕Щ (3 Tier)

   **Tier 1 тЖТ Tier 2 тЖТ Tier 3**

   р╣Бр╕Хр╣Ир╕ер╕░ Tier:
   тФЬтФАтФА р╕лр╕ер╕▓р╕вр╕гр╕░р╕Фр╕▒р╕Ъ (Level)
   тФЬтФАтФА р╣Ар╕Ыр╣Йр╕▓р╕лр╕бр╕▓р╕вр╣Ар╕Фр╕┤р╕бр╕Юр╕▒р╕Щ
   тФЬтФАтФА р╕гр╕░р╕вр╕░р╣Ар╕зр╕ер╕▓р╕Ир╕│р╕Бр╕▒р╕Ф
   тФФтФАтФА р╕гр╕▓р╕Зр╕зр╕▒р╕ер╣Ар╕бр╕╖р╣Ир╕нр╕кр╕│р╣Ар╕гр╣Зр╕И

4. р╕гр╕░р╕лр╕зр╣Ир╕▓р╕Зр╕бр╕┤р╕Кр╕Кр╕▒р╕Щ
   тФЬтФАтФА р╕гр╕░р╕Ър╕Ър╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕вр╕нр╕Фр╣Ар╕Фр╕┤р╕бр╕Юр╕▒р╕Щр╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤
   тФЬтФАтФА р╕гр╕▒р╕Ър╕Бр╕▓р╕гр╣Бр╕Ир╣Йр╕Зр╣Ар╕Хр╕╖р╕нр╕Щ Follow-up
   тФФтФАтФА р╣Бр╕Ир╣Йр╕Зр╕Ьр╕ер╕кр╕│р╣Ар╕гр╣Зр╕И/р╕ер╣Йр╕бр╣Ар╕лр╕ер╕з

5. р╕гр╕▒р╕Ър╕гр╕▓р╕Зр╕зр╕▒р╕е
   тФЬтФАтФА р╕Др╕ер╕┤р╕Бр╕гр╕▒р╕Ър╕гр╕▓р╕Зр╕зр╕▒р╕ер╣Гр╕Щ LINE
   тФЬтФАтФА р╕гр╕░р╕Ър╕Ър╕кр╣Ир╕Зр╣Др╕Ыр╕нр╕Щр╕╕р╕бр╕▒р╕Хр╕┤р╕ар╕▓р╕вр╕Щр╕нр╕Б
   тФФтФАтФА р╣Др╕Фр╣Йр╕гр╕▒р╕Ър╕Бр╕▓р╕гр╣Бр╕Ир╣Йр╕Зр╣Ар╕Хр╕╖р╕нр╕Щр╕Ьр╕е
```

---

## ЁЯФД **Core Business Flow**

### Mission Flow
```
р╕кр╕гр╣Йр╕▓р╕Зр╕бр╕┤р╕Кр╕Кр╕▒р╕Щ
    тЖУ
р╣Ар╕гр╕┤р╣Ир╕б Processing (Tier 1, Level 1)
    тЖУ
р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕вр╕нр╕Фр╣Ар╕Фр╕┤р╕бр╕Юр╕▒р╕Щр╕гр╕▓р╕вр╕зр╕▒р╕Щ тЖРтФАтФА API р╕ар╕▓р╕вр╕Щр╕нр╕Б
    тЖУ
р╕Цр╕╢р╕Зр╣Ар╕Ыр╣Йр╕▓р╕лр╕бр╕▓р╕в? тФАтФАтФА YES тФАтФАтЖТ Level р╕кр╕│р╣Ар╕гр╣Зр╕И
    тФВ                        тЖУ
    NO                  р╕бр╕╡ Level р╕Хр╣Ир╕нр╣Др╕Ы?
    тЖУ                        тФВ
р╕лр╕бр╕Фр╣Ар╕зр╕ер╕▓ Level               YES тФАтФАтЖТ р╣Др╕Ы Level р╕Цр╕▒р╕Фр╣Др╕Ы
    тЖУ                        тФВ
Level р╕ер╣Йр╕бр╣Ар╕лр╕ер╕з                NO
    тЖУ                        тЖУ
р╕ер╕нр╕З Level р╣Гр╕лр╕бр╣И         Tier р╕кр╕│р╣Ар╕гр╣Зр╕И тЖТ р╕гр╕нр╕гр╕▒р╕Ър╕гр╕▓р╕Зр╕зр╕▒р╕е
    тФВ                        тЖУ
    тФФтФАтФА р╕ер╣Йр╕бр╣Ар╕лр╕ер╕з 3 р╕Др╕гр╕▒р╣Йр╕З      р╕Др╕ер╕┤р╕Бр╕гр╕▒р╕Ър╕гр╕▓р╕Зр╕зр╕▒р╕е
         тЖУ                   тЖУ
    р╕бр╕┤р╕Кр╕Кр╕▒р╕Щр╕ер╣Йр╕бр╣Ар╕лр╕ер╕з           р╕кр╣Ир╕Зр╣Др╕Ыр╕нр╕Щр╕╕р╕бр╕▒р╕Хр╕┤ (API)
                             тЖУ
                        р╕нр╕Щр╕╕р╕бр╕▒р╕Хр╕┤? тФАтФАтФА YES тФАтФАтЖТ р╣Др╕Ы Tier р╕Цр╕▒р╕Фр╣Др╕Ы
                             тФВ
                             NO тФАтФАтЖТ р╕Бр╕ер╕▒р╕Ър╣Др╕Ыр╕гр╕нр╕гр╕▒р╕Ър╕гр╕▓р╕Зр╕зр╕▒р╕е
```

### Event Processing (Background)
```
р╕гр╕░р╕Ър╕Ъ Scheduler р╕Чр╕│р╕Зр╕▓р╕Щр╕Хр╣Ир╕нр╣Ар╕Щр╕╖р╣Ир╕нр╕З:

тФЬтФАтФА р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ Level р╕лр╕бр╕Фр╣Ар╕зр╕ер╕▓
тФЬтФАтФА р╕кр╣Ир╕Зр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕б Follow-up
тФЬтФАтФА р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕гр╕▓р╕Зр╕зр╕▒р╕ер╕лр╕бр╕Фр╕нр╕▓р╕вр╕╕
тФФтФАтФА р╕нр╕▒р╕Юр╣Ар╕Фр╕Чр╕кр╕Цр╕▓р╕Щр╕░р╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤
```

---

## ЁЯУ▒ **Communication Flow**

### LINE Integration
```
1. р╕Бр╕▓р╕гр╣Бр╕Ир╣Йр╕Зр╣Ар╕Хр╕╖р╕нр╕Щ Follow-up
   тФФтФАтФА р╣Бр╕кр╕Фр╕Зр╕вр╕нр╕Фр╣Ар╕Фр╕┤р╕бр╕Юр╕▒р╕Щр╕Ыр╕▒р╕Ир╕Ир╕╕р╕Ър╕▒р╕Щ vs р╣Ар╕Ыр╣Йр╕▓р╕лр╕бр╕▓р╕в

2. р╣Бр╕Ир╣Йр╕Зр╕Ьр╕ер╕бр╕┤р╕Кр╕Кр╕▒р╕Щ
   тФЬтФАтФА р╕кр╕│р╣Ар╕гр╣Зр╕И/р╕ер╣Йр╕бр╣Ар╕лр╕ер╕з
   тФФтФАтФА р╕Вр╣Йр╕нр╕бр╕╣р╕е Tier/Level

3. р╕Бр╕▓р╕гр╕гр╕▒р╕Ър╕гр╕▓р╕Зр╕зр╕▒р╕е
   тФЬтФАтФА р╣Бр╕Ир╣Йр╕Зр╕гр╕▓р╕Зр╕зр╕▒р╕ер╕Юр╕гр╣Йр╕нр╕бр╕гр╕▒р╕Ъ
   тФЬтФАтФА р╕Щр╕▒р╕Ър╕Цр╕нр╕вр╕лр╕ер╕▒р╕Зр╕лр╕бр╕Фр╕нр╕▓р╕вр╕╕
   тФФтФАтФА р╕вр╕╖р╕Щр╕вр╕▒р╕Щр╕гр╕▒р╕Ър╕гр╕▓р╕Зр╕зр╕▒р╕ер╣Бр╕ер╣Йр╕з
```

### Telegram (р╕кр╕│р╕лр╕гр╕▒р╕Ъ Admin)
```
р╣Бр╕Ир╣Йр╕Зр╣Ар╕Хр╕╖р╕нр╕Щр╣Ар╕бр╕╖р╣Ир╕нр╕бр╕╡р╕Бр╕▓р╕гр╕Вр╕нр╕гр╕▒р╕Ър╕гр╕▓р╕Зр╕зр╕▒р╕е
тФЬтФАтФА р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Ьр╕╣р╣Йр╣Гр╕Кр╣Й
тФЬтФАтФА р╕Ир╕│р╕Щр╕зр╕Щр╕гр╕▓р╕Зр╕зр╕▒р╕е
тФФтФАтФА р╕кр╕Цр╕▓р╕Щр╕░р╕Бр╕▓р╕гр╕нр╕Щр╕╕р╕бр╕▒р╕Хр╕┤
```

---

## ЁЯФЧ **External Integrations**

### API р╕ар╕▓р╕вр╕Щр╕нр╕Б
```
1. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕вр╕нр╕Фр╣Ар╕Фр╕┤р╕бр╕Юр╕▒р╕Щ
   GET /players/v1/line/rewards/claim

2. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╣Ар╕Ър╕нр╕гр╣Мр╣Вр╕Чр╕г
   POST /players/v1/line/sync

3. р╕Вр╕нр╕гр╕▒р╕Ър╕гр╕▓р╕Зр╕зр╕▒р╕е
   POST /players/v1/line/rewards/claim
   тФФтФАтФА Callback р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Ьр╕ер╕Бр╕▓р╕гр╕нр╕Щр╕╕р╕бр╕▒р╕Хр╕┤
```

### Firebase
```
р╕нр╕▒р╕Юр╣Вр╕лр╕ер╕Фр╣Бр╕ер╕░р╕Ир╕▒р╕Фр╣Ар╕Бр╣Зр╕Ър╕гр╕╣р╕Ыр╕ар╕▓р╕Ю
тФФтФАтФА р╣Гр╕Кр╣Йр╣Гр╕Щр╕Бр╕▓р╕гр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ Template
```

---

## ЁЯУК **Database Collections**

| Collection | р╕лр╕Щр╣Йр╕▓р╕Чр╕╡р╣И |
|------------|---------|
| `tbl_users` | р╕Вр╣Йр╕нр╕бр╕╣р╕е Admin |
| `tbl_client` | р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Ьр╕╣р╣Йр╣Гр╕Кр╣Йр╕Ир╕▓р╕Б LINE |
| `tbl_mission` | р╕бр╕┤р╕Кр╕Кр╕▒р╕Щр╣Бр╕ер╕░ Tier/Level |
| `tbl_events` | р╕Бр╕│р╕лр╕Щр╕Фр╕Бр╕▓р╕гр╕лр╕бр╕Фр╕нр╕▓р╕вр╕╕ |
| `tbl_config` | р╕Бр╕▓р╕гр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╕гр╕░р╕Ър╕Ъ |
| `tbl_logs_message` | р╕Ыр╕гр╕░р╕зр╕▒р╕Хр╕┤р╕Вр╣Йр╕нр╕Др╕зр╕▓р╕б |
| `tbl_logs` | р╕Ыр╕гр╕░р╕зр╕▒р╕Хр╕┤р╕Бр╕▓р╕гр╕гр╕▒р╕Ър╕гр╕▓р╕Зр╕зр╕▒р╕е |
| `user_bets` | р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Бр╕▓р╕гр╣Ар╕Фр╕┤р╕бр╕Юр╕▒р╕Щ |

---

## ЁЯЪА **Key Features**

1. **Multi-Tier Mission System** - р╕гр╕░р╕Ър╕Ър╕бр╕┤р╕Кр╕Кр╕▒р╕Щ 3 р╕гр╕░р╕Фр╕▒р╕Ър╣Бр╕Ър╕Ър╕Хр╣Ир╕нр╣Ар╕Щр╕╖р╣Ир╕нр╕З
2. **Automated Event Processing** - р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╣Бр╕ер╕░р╕Ыр╕гр╕░р╕бр╕зр╕ер╕Ьр╕ер╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤
3. **Real-time Betting Integration** - р╣Ар╕Кр╕╖р╣Ир╕нр╕бр╕Хр╣Ир╕нр╕Бр╕▒р╕Ър╕гр╕░р╕Ър╕Ър╣Ар╕Фр╕┤р╕бр╕Юр╕▒р╕Щр╣Бр╕Ър╕Ър╣Ар╕гр╕╡р╕вр╕ер╣Др╕Чр╕бр╣М
4. **Multi-channel Communication** - р╕кр╕╖р╣Ир╕нр╕кр╕▓р╕гр╕Ьр╣Ир╕▓р╕Щ LINE р╣Бр╕ер╕░ Telegram
5. **Admin Dashboard** - р╕лр╕Щр╣Йр╕▓р╣Бр╕Фр╕Кр╕Ър╕нр╕гр╣Мр╕Фр╕кр╕│р╕лр╕гр╕▒р╕Ър╕Хр╕┤р╕Фр╕Хр╕▓р╕бр╣Бр╕ер╕░р╕Ир╕▒р╕Фр╕Бр╕▓р╕г
6. **External Reward System** - р╕гр╕░р╕Ър╕Ър╕нр╕Щр╕╕р╕бр╕▒р╕Хр╕┤р╕гр╕▓р╕Зр╕зр╕▒р╕ер╕Ьр╣Ир╕▓р╕Щ API р╕ар╕▓р╕вр╕Щр╕нр╕Б

---
